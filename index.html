<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header, footer {
      background-color: #003366;
      color: white;
      text-align: center;
      width: 100%;
      padding: 10px;
    }
    .form-container {
      background: white;
      margin-top: 20px;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
      width: 90%;
      max-width: 400px;
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      background: #003366;
      color: white;
      cursor: pointer;
    }
    .hidden {
      display: none;
    }
    .loading {
      display: none;
      margin-top: 10px;
      text-align: center;
    }
    @media (max-width: 600px) {
      .form-container {
        width: 95%;
      }
    }
  </style>
</head>
<body>

<header>
  <img src="logo.png" height="40">
  <h2>Login System</h2>
</header>

<!-- Step 1: Login -->
<div class="form-container" id="login-form">
  <input type="text" id="username" placeholder="Username" required>
  <input type="password" id="password" placeholder="Password" required>
  <input type="text" id="ceu" placeholder="CEU Number" required>
  <button onclick="verifyLogin()">Login</button>
  <div class="loading" id="loading1">
    <img src="loading.gif" width="40"><br>Loading...
  </div>
</div>

<!-- Step 2: Personal Info -->
<div class="form-container hidden" id="info-form">
  <input type="text" id="fname" placeholder="اسم">
  <input type="text" id="lname" placeholder="تخلص">
  <input type="text" id="nationality" placeholder="ملیت">
  <input type="text" id="passport" placeholder="شماره پاسپورت یا کارت ملی">
  <input type="text" id="caseNumber" placeholder="شماره پرونده">
  <button onclick="verifyData()">Submit</button>
  <div class="loading" id="loading2">
    <img src="loading.gif" width="40"><br>Processing...
  </div>
</div>

<!-- Step 3: Dashboard -->
<div class="form-container hidden" id="dashboard">
  <h3>خوش آمدید</h3>
  <button id="btn1">مدرک 1</button>
  <button id="btn2">مدرک 2</button>
  <button id="btn3">مدرک 3</button>
  <button id="btn4">مدرک 4</button>
  <button id="btn5">مدرک 5</button>
</div>

<footer>
  <img src="logo.png" height="40">
  <p>Powered by You</p>
</footer>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbwhwCOA4J-b-YfCdAkGAPCMoeesqq_zOAQ-tNYg0os8qBIYGeq-HKNwQI3GA37lMM3JqA/exec';

  function verifyLogin() {
    const username = document.getElementById("username").value;
    const password = document.getElementById("password").value;
    const ceu = document.getElementById("ceu").value;

    document.getElementById("loading1").style.display = "block";

    fetch(${scriptURL}?username=${username}&password=${password}&ceu=${ceu})
      .then(res => res.json())
      .then(data => {
        setTimeout(() => {
          document.getElementById("loading1").style.display = "none";
          if (data.success) {
            document.getElementById("login-form").classList.add("hidden");
            document.getElementById("info-form").classList.remove("hidden");
          } else {
            alert("اطلاعات وارد شده نادرست است.");
          }
        }, 5000);
      });
  }

  function verifyData() {
    const fname = document.getElementById("fname").value;
    const lname = document.getElementById("lname").value;
    const nationality = document.getElementById("nationality").value;
    const passport = document.getElementById("passport").value;
    const caseNumber = document.getElementById("caseNumber").value;

    document.getElementById("loading2").style.display = "block";

    fetch("data.json")
      .then(response => response.json())
      .then(json => {
        setTimeout(() => {
          document.getElementById("loading2").style.display = "none";

          const found = json.find(item =>
            item.firstname === fname &&
            item.lastname === lname &&
            item.nationality === nationality &&
            item.passport === passport &&
            item.caseNumber === caseNumber
          );

          if (found) {
            document.getElementById("info-form").classList.add("hidden");
            document.getElementById("dashboard").classList.remove("hidden");

            document.getElementById("btn1").onclick = () => location.href = found.link1;
            document.getElementById("btn2").onclick = () => location.href = found.link2;
            document.getElementById("btn3").onclick = () => location.href = found.link3;
            document.getElementById("btn4").onclick = () => location.href = found.link4;
            document.getElementById("btn5").onclick = () => location.href = found.link5;
          } else {
            alert("اطلاعات شما در سیستم پیدا نشد.");
          }
        }, 5000);
      });
  }
</script>

</body>
</html>
